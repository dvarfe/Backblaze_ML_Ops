# Описание поставленной задачи

## Источник данных
Данные предоставлены компанией Backblaze и содержат информацию о состоянии жестких дисков. Основные характеристики данных:
- Метрики состояния дисков (SMART-атрибуты).
- Метки отказов (failure).

## Data Quality
Для анализа качества данных собираются различные статистики, такие как:\
    - 'data_size': 'количество наблюдений в данных.',\
    - 'min_date': 'дата первого наблюдения.',\
    - 'max_date': 'дата последнего наблюдения.',\
    - 'mean_lifetime': 'средняя продолжительность работы дисков.',\
    - 'max_lifetime': 'максимальная продолжительность работы дисков.',\
    - 'na_rate': 'доля пропущенных данных в каждом столбце.',\
    - 'truncated_rate': 'доля truncated наблюдений.',\
    - 'survival_rate': 'доля выживших дисков.',\
    - 'failure_rate': 'доля отказавших дисков.',\
    - 'double_failures': 'доля дисков, которые отказали более одного раза.',\
    - 'mean_time_between_observ': 'среднее время между наблюдениями диска.',\
    - 'mean_observ_per_day': 'среднее количество наблюдений в день.'

Версии моделей и их метрики сохраняются в папке `Models/` для воспроизводимости.

## Сохранение артефактов
- **Обученные модели**: сериализуются и сохраняются в формате `.pkl` в папке `Models/`.
- **Логи обучения**: сохраняются в папке `Reports/`.

---

# Проектирование модели

## Обработка признакового пространства
1. **Сбор данных**:
   - Данные собираются батчами с использованием конфигурационного файла (`Config/analyzer_cfg.json`).
   - Хранятся в директории `./Data/Data_collected`.

2. **Анализ данных**:
   - Вычисляются статические метрики, такие как:
     - Размер данных (`data_size`).
     - Даты первого и последнего наблюдений (`min_date`, `max_date`).
     - Средняя и максимальная продолжительность работы дисков (`mean_lifetime`, `max_lifetime`).
     - Доля пропущенных данных (`na_rate`).
     - Доля усеченных наблюдений (`truncated_rate`).
     - Доля выживших и отказавших дисков (`survival_rate`, `failure_rate`).
     - Доля дисков с повторными отказами (`double_failures`).
     - Среднее время между наблюдениями и количество наблюдений в день (`mean_time_between_observ`, `mean_observ_per_day`).

3. **Разбиение на обучающую и тестовую выборки**:
   - Используется стратифицированное разбиение по метке отказа (`failure`).
   - Удаляются truncated данные из тестовой выборки.
4. **Удаление некорректных дисков**
    - Удаление дисков с более чем одним отказом
5. **Обработка пропущенных значений**:
   - Удаление столбцов с большим количеством пропусков.
   - Заполнение пропусков последним известным значением.
6. **Кодирование категориальных признаков**:
   - One-hot encoding для сезона.
   - Label encoding для частой категории моделей.
7. **Нормализация числовых признаков**:
   - Масштабирование данных - Standard Scaler.
8. **Семплинг подвыборок меньшего размера**


## Модели
### Логистическая регрессия
- **Регуляризация**: L1, L2.
- **Параметр регуляризации (C)**: контролирует степень регуляризации.

### Многослойный персептрон (NN)
- **Количество слоев**: от 1 до 3.
- **Количество нейронов в слое**: от 32 до 256.
- **Функция активации**: ReLU, Sigmoid.
- **Оптимизатор**: Adam, SGD.
- **Параметры обучения**:
  - Learning rate.
  - Batch size.
  - Количество эпох.

### Реализованная архитектура модели

Архитектура модели представляет собой многослойный персептрон (MLP) для бинарной классификации. Основные компоненты:

1. **Входной слой**:
   - Принимает вектор признаков размерностью `input_dim`.

2. **Скрытые слои**:
   - Два скрытых слоя с количеством нейронов, равным `hidden_dim` (по умолчанию 64).
   - Каждый слой использует функцию активации ReLU для нелинейности.

3. **Выходной слой**:
   - Один нейрон с функцией активации Sigmoid для предсказания вероятности класса.

4. **Оптимизация**:
   - Используется оптимизатор Adam с настраиваемой скоростью обучения (`lr`, по умолчанию 1e-3).
   - Функция потерь — бинарная кросс-энтропия (BCELoss).

5. **Обучение**:
   - Модель обучается на батчах данных, предоставляемых DataLoader.
   - Поддерживается обучение на GPU (если доступно) или CPU.

6. **Предсказания**:
   - Модель предсказывает вероятности выживания на заданных временных точках.
   - Реализована возможность вычисления ожидаемого времени до события на основе предсказанных функций выживания.

